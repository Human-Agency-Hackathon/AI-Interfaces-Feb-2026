# Bulletin Board Archive

> **Completed and acknowledged messages from the [Bulletin Board](TASKS.md#bulletin-board).** Messages are moved here once their action items are fully resolved or the information has been acknowledged by all relevant parties. This keeps the active board in `TASKS.md` focused on open items.
>
> **When to archive:** See the archival rules in `CLAUDE.md` under "Use the Bulletin Board."

---

## Archived 2026-02-21

The following messages were archived because all action items are resolved or the information has been acknowledged.

| Date | Time | Agent (Owner) | Message |
|------|------|---------------|---------|
| 2026-02-21 | — | Ken | **@Behrang: Gap analysis complete. Two core workstreams to get end-to-end brainstorm working. Details below.** |
| | | | **SERVER WORKSTREAM — Make DEEP_BRAINSTORM the real deal** |
| | | | 1. **Switch default template.** `BridgeServer.ts:226` defaults to `STANDARD_BRAINSTORM` (3-stage). Change it to use `DEEP_BRAINSTORM` (7-stage, already fully defined in `ProcessTemplates.ts` with 11 personas). The types and roles are all there; it just needs to be selected. |
| | | | 2. **Parallel turn handling in ProcessController.** Currently `driveNextSequentialAgent()` only handles `sequential` turn structures. DEEP_BRAINSTORM has `parallel` on `divergent_thinking` and `critique` stages. When `turnStructure.type === 'parallel'`, the controller needs to send follow-up prompts to ALL agents in the stage simultaneously instead of one-at-a-time. Turn counting should track each agent independently and only advance the stage when all parallel agents have hit the turn count. |
| | | | 3. **Thread artifacts between stages.** Each stage produces artifacts (framing doc, idea list, candidate list, critique notes, rankings). These need to flow into the next stage's system prompt. `SystemPromptBuilder.buildProcessPrompt()` already accepts `priorArtifacts` — the gap is that `BridgeServer` / `ProcessController` isn't collecting PostFindings output per stage and passing it through `processContext.priorArtifacts` when spawning the next stage's agents. Wire up: when a stage completes, collect all findings posted during that stage, store them as the stage's artifacts, and include them in the next stage's spawn context. |
| | | | 4. **Use rich persona data from DEEP_BRAINSTORM roles.** `BridgeServer.ts:350` currently gives all agents the same generic mission string. The `DEEP_BRAINSTORM` roles have detailed `persona` fields (e.g. "The Wild Ideator: enthusiastically uninhibited, quantity over quality"). These need to make it into the actual agent system prompt. Map each spawned agent's role ID to the matching `RoleDefinition` and pass the persona text through to `SystemPromptBuilder`. |
| | | | **CLIENT WORKSTREAM — Process visualization** |
| | | | 5. **Handle `stage:advanced` messages.** `main.ts` has NO handler for `stage:advanced`. Add a handler that updates a stage progress UI component. |
| | | | 6. **Build a Stage Progress Bar / Banner.** New DOM overlay showing: current stage name, stage X of Y. Updates on `stage:advanced`. |
| | | | 7. **Stage transition announcement.** When `stage:advanced` fires, show a DialogueLog entry ("Stage complete: Divergent Thinking. Entering: Convergent Thinking..."). |
| | | | 8. **Surface findings in DialogueLog.** `findings:posted` currently goes to `console.log` only (`main.ts:94`). Dispatch it to the DialogueLog panel — this is the core content of the brainstorm. |
| | | | 9. **Show agent role names.** Agent role (e.g. "The Wild Ideator") should show on sprite label and dialogue log, not just agent ID. |
| | | | **PRIORITY:** Items 1-4 (server) gate everything. Items 5+8 (client) are highest value for watchability. |
| | | | **✅ RESOLVED:** Behrang confirmed all 9 items done (see below). |
| 2026-02-21 | — | Jeff's agent | @Ken: Confirming Ken's gap analysis is exactly right. Also flagging `docs/BRAINSTORM-E2E.md` — Behrang wrote it and it contains ready-to-paste code for a parallel orchestrator-driven approach (Gap 1: parent-child spawn tracking, Gap 2: all-children-idle notification, Gap 3: `player:start-brainstorm` entry point). Ken's items 1-4 are the ProcessController path. The E2E doc is the orchestrator-driven path. They're complementary; Ken's items are higher priority for the structured demo. |
| | | | **✅ RESOLVED:** Acknowledged; gap analysis acted on. |
| 2026-02-21 | — | Jeff's agent | @Behrang: Ken's 9 items are the priority list. On top of those — `docs/BRAINSTORM-E2E.md` (which you wrote) has parallel-track code ready to paste for parent-child spawn tracking and the all-children-idle wakeup. Once Ken's items 1-4 land, that doc's gaps are the next layer. Great work getting all tasks 1-11 done. |
| | | | **✅ RESOLVED:** Acknowledged; Behrang completed all items. |
| 2026-02-21 | — | Behrang | Fixed server log noise: (1) `BridgeServer.close()` now sends a proper WS close frame (1001) instead of `terminate()` so Python agents disconnect cleanly — no more `ConnectionClosedError`; (2) `index.ts` filters the SDK's internal "Operation aborted" unhandled rejection (expected when `AbortController` fires mid-session). Also ran `npm install` to pick up Pratham's `ioredis` dep — build is clean. Next: Ken's items 1-4 (DEEP_BRAINSTORM default, parallel turns, artifact threading, rich personas). |
| | | | **✅ RESOLVED:** Fixes landed and pushed. |
| 2026-02-21 | — | Behrang | **All 9 of Ken's items are DONE.** Here's what landed: |
| | | | **Server (items 1-4):** (1) Default template switched to DEEP_BRAINSTORM (7-stage, 11 personas). (2) ProcessController now handles parallel turn structures — per-agent turn tracking, stage completes only when ALL parallel agents hit their count, agents get follow-up prompts for additional turns. (3) Findings are threaded as stage artifacts via WorldState.setArtifact — each PostFindings call stores the finding per-stage, flowing to next stage's system prompt through priorArtifacts. (4) Persona data was already wired (roleDef.persona → processContext → SystemPromptBuilder). |
| | | | **Client (items 5-9):** (5) `stage:advanced` handler in main.ts updates progress bar and dispatches announcements. (6) StageProgressBar panel created — shows stage name, progress bar, counter at sidebar top. (7) Stage transition announcements show in DialogueLog. (8) `findings:posted` now surfaces in DialogueLog (was console.log only). (9) Agent role names already display on sprites via roleLabel; UIScene now also uses display names instead of raw IDs in thought/activity bubbles. |
| | | | **Protocol fixes:** StageAdvancedMessage aligned between server broadcast and shared types (added fromStageName, totalStages). ProcessStartedMessage now includes totalStages. |
| | | | **Also fixed:** WASD key interception during name entry (CameraController rewritten upstream), and canvas stealing focus from JoinScreen name input (removed postBoot auto-focus). |
| | | | **✅ RESOLVED:** All items implemented and verified. |
| 2026-02-21 | — | Ken | **@Jeff: Question about subagent behavior during brainstorming.** It looks like our brainstorm process is doing a lot of local file reading. Why is this happening? How is local file I/O part of a brainstorming session? The brainstorm should be idea generation, not codebase analysis. If agents are reading files as part of how they solve their brainstorm tasks, we need to understand and document that behavior. **Ask:** Can you document how the subagents are actually solving their tasks during each brainstorm stage? What tools are they calling, what's their workflow, and why are they hitting the filesystem? Please make a Mermaid diagram (`graph TD`) showing the agent task-solving flow: what each agent does step-by-step during its stage, including any tool calls, file reads, findings posts, etc. Drop it in `docs/` so the whole team can see it. |
| | | | **✅ RESOLVED:** Jeff answered; see `docs/agent-task-solving-flow.md`. Root cause: `Read`/`Glob`/`Grep` in `allowedTools` + no prompt instruction to avoid them. |
| 2026-02-21 | — | Jeff's agent | **@Ken: answered your question — see `docs/agent-task-solving-flow.md`.** Short answer: agents read files because `Read`/`Glob`/`Grep` are in `allowedTools` (from `read-only` permission level) and the system prompt never tells them not to use those tools. Claude's default is to gather context before responding, so it reaches for the filesystem even in a brainstorm. Fix is one line in `buildProcessPrompt()`: "DO NOT use Read, Glob, or Grep." **@Behrang: this is a quick win** — add that line to `SystemPromptBuilder.ts` `buildProcessPrompt()`. It immediately stops file I/O in brainstorm stages. The proper fix (Option A: empty `allowedTools` for brainstorm agents) is in the doc too. |
| | | | **✅ RESOLVED:** Question answered; fix identified. One-line fix still tracked on active board. |
| 2026-02-21 | — | Ken | **Created `docs/diagrams/` folder with 6 Mermaid diagram documents for onboarding and visibility.** Covers: system overview, agent lifecycle (spawn/run/shutdown), agent communication (findings board, prompt injection, RequestHelp, player-routed commands, groupthink prevention), brainstorm process (all 9 stages, parallel/sequential, conditional branches, human gates), client rendering (screen flow, scenes, data flow, DOM panels), and data persistence (vaults, Redis, realms, transcripts). **New agent sessions: start at `docs/diagrams/README.md`.** @Behrang @Ida @Jeff @Pratham: these are designed as the onboarding docs for your agents. If anything's wrong or missing, update them. |
| | | | **✅ RESOLVED:** Informational; diagrams created and available. |
| 2026-02-21 | — | Ken | **Test coverage + path traversal hardening.** Added ~130 new tests (server went from 71% to ~90% file coverage). New test files: ProcessController (29 tests), SystemPromptBuilder (23), LocalTreeReader (14), RepoAnalyzer (16), PathBoundary (36), Python protocol (15). Expanded: CustomToolHandler (+3), WorldState (+15), MapGenerator (+12), RpgMcpServer (+3). Also created `PathSafety.ts` utility and hardened KnowledgeVault, TranscriptLogger, WorldStatePersistence, and LocalTreeReader against path traversal attacks (agentId/realmId with `../` no longer escapes the repo root; symlinks outside root are skipped). **@Behrang:** If you're adding any new file I/O paths, use `sanitizePathComponent()` from `PathSafety.ts` for any user-supplied path component. **@Pratham:** FindingsBoard tests still skipped in CI (needs Redis). The JSON fallback Ken asked for earlier would unblock these. |
| | | | **✅ RESOLVED:** Informational; tests and hardening landed. PathSafety note to Behrang still relevant (general guidance, not a blocker). |
| 2026-02-21 | — | Behrang | **Server error fixes + client UI wiring + E2E brainstorm verified.** (1) Fixed `ws.terminate()` → graceful `ws.close(1001)` with 2s timeout fallback — eliminates Python `ConnectionClosedError`. (2) Added `unhandledRejection` filter in `index.ts` to suppress SDK "Operation aborted" noise. (3) Fixed CSS class name mismatch in `index.html` to match `StageProgressBar.ts` real class names; removed conflicting static `#stage-progress` div. (4) Added `agent-joined` window event dispatch in `main.ts` so `UIScene` agentInfo map populates. (5) Updated `UIScene.ts` to display agent names ("The Cartographer") instead of raw IDs. **E2E brainstorm confirmed working:** Stage 1 (Problem Framing) → Stage 2 (Divergent Thinking) → Stage 3 (Convergent Thinking) all advanced correctly; 29+ findings posted by 6 agents in ~5 min. All `agent:joined`, `agent:activity`, `findings:posted`, `stage:advanced`, `agent:level-up` events flowing. **@Ida:** Client-side display names and stage progress bar should now work correctly when you test the UI. **@Jeff:** Agent activity is rich — findings are detailed and substantive across all stages tested. |
| | | | **✅ RESOLVED:** E2E verified; informational. |
| 2026-02-21 | — | Pratham | **Task 47 done: Redis Pub/Sub for real-time agent notifications.** All 212 server tests pass (4 new). What landed: (1) `getRedisClientDuplicate()` in RedisClient for dedicated subscriber connections; (2) `RedisPubSub.ts` singleton with `publish/subscribe/unsubscribe/close` — graceful no-op when Redis unavailable; (3) `FindingsBoard.addFinding()` now publishes to `findings:broadcast` channel on every finding (Redis mode only); (4) `BridgeServer` tracks parent-child spawn relationships (`spawnParent`/`spawnChildren` maps); (5) Gap 2 idle handler: when all spawned children go idle, parent agent is woken up with consolidated findings via `sendFollowUp`; (6) `agent:idle:broadcast` published to Redis on every idle event; (7) shutdown sequence closes pub/sub before main Redis client. Degrades gracefully — `[RedisPubSub] Redis unavailable, pub/sub disabled` when Redis is not running. **@Behrang:** Gap 2 (all-children-idle notification) is now wired in the `agent:idle` handler. SummonAgent-spawned children now automatically wake their parent when all siblings complete. |
| | | | **✅ RESOLVED:** Pub/sub implemented and working. |
